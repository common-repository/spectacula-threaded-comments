{"version":3,"file":"quote.min.js","sources":["quote.js"],"sourcesContent":["jQuery( document ).ready( function( $ ) {\r\n\r\n\tfunction spec_get_selected_text( ) {\r\n\t\tvar txt;\r\n\r\n\t\tif ( window.getSelection ) {\r\n\t\t\ttxt = window.getSelection( );\r\n\t\t} else if ( document.getSelection ) {\r\n\t\t\ttxt = document.getSelection( );\r\n\t\t} else if ( document.selection ) {\r\n\t\t\ttxt = document.selection.createRange( ).text;\r\n\t\t}\r\n\r\n\t\treturn txt.toString( ) != '' ? txt.toString( ) : false;\r\n\t}\r\n\r\n\r\n\t// Is the current box our floating hover?\r\n\tfunction is_quote_hover( e ) {\r\n\t\treturn e.id != null && ( e.id === 'quote-float' || is_quote_hover( e.parentNode ) );\r\n\t}\r\n\r\n\r\n\t// Add the quote button to each comment.\r\n\tfunction spec_add_quote_button( e ) {\r\n\t\t$( e ).children( '.comment-body' ).find( '.comment-buttons' ).append( $( '<a href=\"#\" class=\"comment-button\">' + specQuoteLn.button_text + '</a>' ).click( function( ) {\r\n\t\t\tspec_quote_comment( this );\r\n\t\t\treturn false;\r\n\t\t} ) );\r\n\t}\r\n\r\n\r\n\tfunction spec_quote_comment( e ) {\r\n\t\tvar text = $( e ).parents( '.comment-buttons' ).prev( '.comment-text' ).html( ),\r\n\t\t\tauth = $( e ).parents( '.comment-buttons' ).siblings( '.comment-meta' ).find( 'cite.fn' ).text( ),\r\n\t\t\tresu = '';\r\n\r\n\t\tresu = '<blockquote cite=\"' + $.trim( auth ) + '\">\\n<cite>' + $.trim( auth ) + '</cite>\\n' + $.trim( text ) + '\\n</blockquote>\\n';\r\n\t\tinsert_at_carret( 'comment', resu );\r\n\t}\r\n\r\n\r\n\tfunction ie_carret_pos( e ) {\r\n\t\te.focus( );\r\n\t\tvar r = document.selection.createRange( ),\r\n\t\t\tre = e.createTextRange( ),\r\n\t\t\trc = re.duplicate( );\r\n\r\n\t\tre.moveToBookmark( r.getBookmark( ) );\r\n\t\trc.setEndPoint( 'EndToStart', re );\r\n\r\n\t\treturn r == null ? 0 : rc.text.length;\r\n\t}\r\n\r\n\r\n\tfunction insert_at_carret( id, txt ) {\r\n\t\tvar e = document.getElementById( id ),\r\n\t\t\tt = e.value,\r\n\t\t\tp = e.selectionStart !== undefined ? e.selectionStart : ie_carret_pos( e );\r\n\r\n\t\t$( '#' + id ).val( t.substring( 0, p ) + txt + t.substring( p, t.length ) ).trigger( 'keyup' );\r\n\t\t$.scrollTo( '#' + id, { duration: 500, axis: 'y', onAfter: function( e ){\r\n\t\t\tjQuery( '#' + id ).focus( );\r\n\t\t} } );\r\n\t}\r\n\r\n\r\n\tif ( specQuoteLn.quote_button ) {\r\n\t\t// Bind to my custom new comment event\r\n\t\t$( '.comment' ).each( function( ) {\r\n\t\t\tspec_add_quote_button( this );\r\n\t\t} ).on( 'newComment', function( ){\r\n\t\t\tspec_add_quote_button( this );\r\n\t\t} );\r\n\t}\r\n\r\n\r\n\tif ( specQuoteLn.quote_select ) {\r\n\t\t$( specQuoteLn.quote_target ).mouseup( function( e ) {\r\n\t\t\tvar txt = spec_get_selected_text( ),\r\n\t\t\t\ta = $( e.currentTarget ), // Or originalTarget for the element clicked.\r\n\t\t\t\ty = e.pageY,\r\n\t\t\t\tsx = e.pageX,\r\n\t\t\t\tex = a.offset( ).left + a.width( );\r\n\r\n\t\t\tif ( txt ) {\r\n\t\t\t\t$( '<div><span>' + specQuoteLn.button_text + '</span></div>' )\r\n\t\t\t\t\t.attr( { id: 'quote-float' } )\r\n\t\t\t\t\t.appendTo( 'body' )\r\n\t\t\t\t\t.css( {\r\n\t\t\t\t\t\tposition: 'absolute',\r\n\t\t\t\t\t\tleft: sx + 1, // + 1 px to avoid an IE 6,7,8 & 9 bug with the redraw\r\n\t\t\t\t\t\ttop: y - ( $( '#quote-float' ).height( ) / 2 ) ,\r\n\t\t\t\t\t\tzIndex: 1000\r\n\t\t\t\t\t} )\r\n\t\t\t\t\t.animate( { left: ex + 10 }, 500 )\r\n\t\t\t\t\t.click( function( ) {\r\n\t\t\t\t\t\tinsert_at_carret( 'comment', '<blockquote>\\n' + $.trim( txt ) + '\\n</blockquote>\\n' );\r\n\t\t\t\t\t\t$( '#quote-float' ).remove( );\r\n\t\t\t\t\t} );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\r\n\t\t// Kill the quote hover button when someone clicks elsewhere.\r\n\t\t$( document ).mousedown( function( e ) {\r\n\t\t\tvar trgt = e.target || window.event.srcElement;\r\n\t\t\tif ( ! is_quote_hover( trgt ) )\r\n\t\t\t\t$( '#quote-float' ).remove( );\r\n\t\t} );\r\n\t}\r\n\r\n} );\r\n"],"names":["jQuery","document","ready","$","spec_add_quote_button","e","children","find","append","specQuoteLn","button_text","click","text","auth","this","parents","prev","html","siblings","insert_at_carret","trim","id","txt","getElementById","t","value","p","undefined","selectionStart","focus","r","selection","createRange","re","createTextRange","rc","duplicate","moveToBookmark","getBookmark","setEndPoint","length","ie_carret_pos","val","substring","trigger","scrollTo","duration","axis","onAfter","quote_button","each","on","quote_select","quote_target","mouseup","window","getSelection","toString","a","currentTarget","y","pageY","sx","pageX","ex","offset","left","width","attr","appendTo","css","position","top","height","zIndex","animate","remove","mousedown","is_quote_hover","parentNode","target","event","srcElement"],"mappings":"AAAAA,OAAQC,UAAWC,MAAO,SAAUC,GAwBnC,SAASC,EAAuBC,GAC/BF,EAAGE,GAAIC,SAAU,iBAAkBC,KAAM,oBAAqBC,OAAQL,EAAG,sCAAwCM,YAAYC,YAAc,QAASC,MAAO,WAO5J,IAA6BN,EACxBO,EACHC,EAPA,OAMGD,EAAOT,EADiBE,EANPS,MAOHC,QAAS,oBAAqBC,KAAM,iBAAkBC,OACvEJ,EAAOV,EAAGE,GAAIU,QAAS,oBAAqBG,SAAU,iBAAkBX,KAAM,WAAYK,OAI3FO,EAAkB,UADX,qBAAuBhB,EAAEiB,KAAMP,GAAS,aAAeV,EAAEiB,KAAMP,GAAS,YAAcV,EAAEiB,KAAMR,GAAS,sBAVtG,KA4BT,SAASO,EAAkBE,EAAIC,GAC9B,IAAIjB,EAAIJ,SAASsB,eAAgBF,GAChCG,EAAInB,EAAEoB,MACNC,OAAyBC,IAArBtB,EAAEuB,eAA+BvB,EAAEuB,eAhBzC,SAAwBvB,GACvBA,EAAEwB,QACF,IAAIC,EAAI7B,SAAS8B,UAAUC,cAC1BC,EAAK5B,EAAE6B,kBACPC,EAAKF,EAAGG,YAKT,OAHAH,EAAGI,eAAgBP,EAAEQ,eACrBH,EAAGI,YAAa,aAAcN,GAElB,MAALH,EAAY,EAAIK,EAAGvB,KAAK4B,OAO0BC,CAAepC,GAExEF,EAAG,IAAMkB,GAAKqB,IAAKlB,EAAEmB,UAAW,EAAGjB,GAAMJ,EAAME,EAAEmB,UAAWjB,EAAGF,EAAEgB,SAAWI,QAAS,SACrFzC,EAAE0C,SAAU,IAAMxB,EAAI,CAAEyB,SAAU,IAAKC,KAAM,IAAKC,QAAS,SAAU3C,GACpEL,OAAQ,IAAMqB,GAAKQ,WAKhBpB,YAAYwC,cAEhB9C,EAAG,YAAa+C,KAAM,WACrB9C,EAAuBU,QACpBqC,GAAI,aAAc,WACrB/C,EAAuBU,QAKpBL,YAAY2C,eAChBjD,EAAGM,YAAY4C,cAAeC,QAAS,SAAUjD,GAChD,IA5EGiB,EA4ECA,GA1EAiC,OAAOC,aACXlC,EAAMiC,OAAOC,eACFvD,SAASuD,aACpBlC,EAAMrB,SAASuD,eACJvD,SAAS8B,YACpBT,EAAMrB,SAAS8B,UAAUC,cAAepB,MAGf,IAAnBU,EAAImC,YAAoBnC,EAAImC,YAmEjCC,EAAIvD,EAAGE,EAAEsD,eACTC,EAAIvD,EAAEwD,MACNC,EAAKzD,EAAE0D,MACPC,EAAKN,EAAEO,SAAUC,KAAOR,EAAES,QAEtB7C,GACJnB,EAAG,cAAgBM,YAAYC,YAAc,iBAC3C0D,KAAM,CAAE/C,GAAI,gBACZgD,SAAU,QACVC,IAAK,CACLC,SAAU,WACVL,KAAMJ,EAAK,EACXU,IAAKZ,EAAMzD,EAAG,gBAAiBsE,SAAY,EAC3CC,OAAQ,MAERC,QAAS,CAAET,KAAMF,EAAK,IAAM,KAC5BrD,MAAO,WACPQ,EAAkB,UAAW,iBAAmBhB,EAAEiB,KAAME,GAAQ,qBAChEnB,EAAG,gBAAiByE,aAOxBzE,EAAGF,UAAW4E,UAAW,SAAUxE,IAvFpC,SAASyE,EAAgBzE,GACxB,OAAe,MAARA,EAAEgB,KAAyB,gBAAThB,EAAEgB,IAAwByD,EAAgBzE,EAAE0E,aAwF7DD,CADIzE,EAAE2E,QAAUzB,OAAO0B,MAAMC,aAEnC/E,EAAG,gBAAiByE"}