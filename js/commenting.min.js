!function(a){a(document).ready(function(){window.addComment={interval:0,replying:0,action_id:0,showOne:commentingL10n.rpl_show_1.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),hideOne:commentingL10n.rpl_hide_1.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),showMany:commentingL10n.rpl_show_2.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),hideMany:commentingL10n.rpl_hide_2.replace("%name%",'<span class="poster-name"></span>').replace("%count%",'<span class="post-count">&nbsp;</span>'),scrollOff:parseInt(commentingL10n.scroll_off,10),moveForm:function(t,e,n,o){var m=a("#"+t+" > .comment-body .comment-meta").next().text(),i=a("#"+t+" > .comment-body cite.fn").text();return addComment.replying&&addComment.cancelReply(),addComment.replying=e,a("#comment-form #comment").before(a('<blockquote class="reply-quote"><cite>'+i+"</cite><p>"+(130<m.length?m.substring(0,129)+"&hellip;":m)+"</p></blockquote>").hide()).prev(".reply-quote").slideDown(),a("#comment-form input#comment_parent").attr({value:e}),a("#"+t+" > .comment-body ").find(".comment-reply-link").hide(),a("#comment-form #cancel-comment-reply-link").show(),"function"==typeof a.scrollTo&&a.scrollTo("#respond",{offset:addComment.scrollOff,duration:500,axis:"y",onAfter:function(t){a("#comment").focus()}}),!1},cancelReply:function(){0!==addComment.replying&&(addComment.replying=0,a("#comment-form .reply-quote").slideUp(500,function(){a(this).remove()}),a("#comment-form input#comment_parent").attr({value:0}),a("#comment-form #cancel-comment-reply-link").hide(),a("#commentlist").find(".comment-reply-link").show()),a("#comment-form .submit").removeAttr("disabled").removeClass("disabled"),addComment.startInterval(!0)},commentDepth:function(t){var e;return t?(e=a("li#comment-"+t).attr("class").match(/\bdepth-(\d+)\b/i),0<parseInt(e[1],10)?parseInt(e[1],10):1):0},error:function(t){return"string"==typeof t&&(a("#comment-form .textarea-border").after(a('<div class="error">'+t+"</div>").hide()).next(".error").slideDown("slow",function(){var t=a(this);void 0!==a(this)[0].style&&(a(this).css("FILTER",""),a(this)[0].style.filter=""),setTimeout(function(){a(t).slideUp("slow",function(){a(this).remove()})},5e3)}),!0)},deleteComment:function(t,e){return a("ul#commentlist li#comment-"+t+", #trackback-list li#comment-"+t).length&&("unapprove"==e&&a("ul#commentlist li#comment-"+t+" > .comment-body:has( .moderation )")||a("li#comment-"+t+" > .comment-body").slideUp("slow",function(){a(this).text("Deleted comment").slideDown().parent("li#comment-"+t).addClass("deleted")})),!0},newComment:function(t,e,n,o,m){var i;return a("ul#commentlist li#comment-"+e+", #trackback-list li#comment-"+e).length?(a("ul#commentlist li#comment-"+e).find(".moderation").slideUp("slow",function(){a(this).remove()}),a("li#comment-"+e).hasClass("deleted")&&a("li#comment-"+e+" > .comment-body").slideUp("slow",function(){a(this).html(a(t).find(".comment-body").html().trigger("newComment")).slideDown("slow")}).removeClass("deleted")):("comment"==m&&0<n?a("ul#commentlist li#comment-"+n).length&&(a("ul#commentlist li#comment-"+n+" > ul.children").length||a("ul#commentlist li#comment-"+n+" > div.comment-body").after('<ul class="children"></ul>'),a("ul#commentlist li#comment-"+n+" > ul.children").append(a(t).hide().addClass("rolledup").trigger("newComment")),null!==(i=a("li#comment-"+n).attr("class").match(/(?:\s|^)depth-(\d+)\s?/i))[1]&&i[1].match(/\d+/)&&(a("ul#commentlist li#comment-"+e).removeClass("depth-1 depth-2 depth-3 depth-4 depth-5 depth-6 depth-7 depth-8 depth-9 depth-10").addClass("depth-"+(parseInt(i[1],10)+1)),parseInt(i[1],10)+1>=commentingL10n.max_depth&&a("ul#commentlist li#comment-"+e+" > div.comment-body .comment-reply-link").remove()),a("#comment-"+e).closest("li:has(div.toggle)").children(".toggle").hasClass("hidden")&&a("#comment-"+e).closest("li:has(div.toggle)").children(".toggle").removeClass("hidden").next("ul.children").slideDown("fast",function(){a(this).prev("div.toggle").css({backgroundPosition:"bottom right"})}),addComment.toggleToggleText(a("#comment-"+e).closest("li:has(div.toggle)").children(".toggle")),addComment.addToggles()):("comment"!==m&&a("#trackback-list").length?a("#trackback-list").append(a(t).hide().addClass("rolledup").trigger("newComment")):"desc"===commentingL10n.order?a("li#response-cont").after(a(t).hide().addClass("rolledup").trigger("newComment")):a("li#response-cont").before(a(t).hide().addClass("rolledup").trigger("newComment")),addComment.addToggles()),o||(a("#comment-"+e).addClass("new").children("#div-comment-"+e).find(".comment-meta").prepend('<span class="new-comment"></span>'),a("#div-comment-"+e).bind("mouseover",function(){a(this).find(".comment-meta span.new-comment").fadeTo(1e3,0,function(){a(this).closest("li").removeClass("new"),a(this).remove()})})),a("ul#commentlist, ul#trackback-list").find(".rolledup").slideDown(500,function(){o&&a.scrollTo("#comment-"+e,{offset:addComment.scrollOff,duration:500,axis:"y"})}).removeClass("rolledup"),"comment"!==m&&addComment.trackbackToggle(400)),!0},submit:function(t){var e=!1;return a(t).find(".vital").each(function(){var t=a(this).val();void 0===t||""===t?(e=!0,a(this).addClass("oops"),setTimeout(function(){a("#comment-form .vital").removeClass("oops")},6e3)):a(this).removeClass("oops")}),e?addComment.error(commentingL10n.err_txt_mis):(addComment.startInterval(!1),a(t).ajaxSubmit({beforeSubmit:function(t){a("#comment-form .submit").attr({disabled:"disabled"}).addClass("disabled")},type:"POST",data:{_spec_ajax:"Why are you looking at this POST data?",action:"new_comment_added",depth:addComment.commentDepth(addComment.replying)},error:function(t,e){var n;500===t.status?(""!==(n=a(t.responseText).text().replace(/(\s+|\t|\r\n|\n|\r)+/g," "))&&void 0!==n||(n=t.status+" "+t.statusText),addComment.error(n)):"string"==typeof e?addComment.error(e):addComment.error("Oops!"),addComment.cancelReply()},success:function(e){var t;try{t=JSON.parse(e)}catch(t){return"string"==typeof e?addComment.error(e):addComment.error("Oops!"),void addComment.cancelReply()}addComment.newComment(t.html,t.comment_ID,t.comment_parent,!0,"comment"),addComment.cancelReply(),a("#comment-form #comment").val("").trigger("keyup")}})),!1},addToggles:function(t){a("#commentlist li.depth-"+commentingL10n.nest_depth+" > ul.children").each(function(){a(this).prev("div.toggle").length||(a(this).before(a('<div class="toggle"></div>').hide().css({opacity:0})),a(this).prev("div.toggle").show().fadeTo("slow",1,function(){void 0!==a(this)[0].style&&(a(this).css("FILTER",""),a(this)[0].style.filter="")})),!0===t&&a(this).hide().prev("div.toggle").addClass("kqofn-hidden"),addComment.toggleToggleText(a(this).prev("div.toggle"))})},toggleToggleText:function(t){return"object"!=typeof t&&"string"==typeof t&&(t=a(t)),t.each(function(){var t=a(this).prev("div.comment-body").find("cite.fn").text(),e=a(this).next("ul.children").find("li.comment").length;a(this).hasClass("kqofn-hidden")?a(this).html(1==e?addComment.showOne:addComment.showMany):a(this).html(1==e?addComment.hideOne:addComment.hideMany),a(this).find(".post-count").text(e),a(this).find(".poster-name").text(""!=t?t:commentingL10n.unknown)}),!0},startInterval:function(t){!0===t?void 0!==commentingL10n.update&&1==commentingL10n.update&&(addComment.interval=setInterval(function(){addComment.getUpdates()},10<=parseInt(commentingL10n.polling,10)?1e3*commentingL10n.polling:1e4)):clearInterval(addComment.interval)},getUpdates:function(){addComment.getCommentUpdates()},getCommentUpdates:function(){var t={_spec_ajax:"Why is everyone looking at me",action:"get_comment_changes",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id};a.post(commentingL10n.ajax_url,t,function(e){var t,n,o;try{t=JSON.parse(e)}catch(t){return void("string"==typeof e?addComment.error(e):addComment.error("Oops!"))}if(null!=t)for(n in t){comment=t[n],void 0!==comment&&(null!==(o=null!==comment.log_date?comment.log_date:comment.comment_date)&&(commentingL10n.time=o),addComment.action_id=null!==comment.action_id?comment.action_id:0,void 0!==comment.html&&null!==t[n].html&&""!==comment.html?addComment.newComment(comment.html,comment.comment_ID,comment.comment_parent,!1,comment.comment_type):addComment.deleteComment(comment.comment_ID,comment.action))}})},getModerationUpdates:function(){var t={_spec_ajax:"Why is everyone looking at me",action:"get_moderation_changes",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id};a.post(commentingL10n.ajax_url,t,function(e){var t,n,o,m;try{t=JSON.parse(e)}catch(t){return void("string"==typeof e?addComment.error(e):addComment.error("Oops!"))}if(null!=t)for(n in t){void 0!==(m=t[n])&&(null!==(o=null!==m.log_date?m.log_date:m.comment_date)&&(commentingL10n.time=o),addComment.action_id=null!==m.action_id?m.action_id:0,void 0!==m.html&&null!==m.html&&""!==m.html&&addComment.newComment(m.html,m.comment_ID,m.comment_parent,!1,m.comment_type))}})},trackbackToggle:function(t){a("#trackback-list").height()>(0<t?t:400)&&!a("#trackback-list").prev(".trackback-toggle").length&&a("#trackback-list").length&&a("#trackback-list").hide().before('<div class="trackback-toggle"><span class="toggle-text">'+commentingL10n.tb_show+"</span></div>").prev(".trackback-toggle").click(function(){a(this).toggleClass("active").next("#trackback-list").slideToggle("fast",function(){a(this).prev(".trackback-toggle").children(".toggle-text").text("none"===a(this).css("display")?commentingL10n.tb_show:commentingL10n.tb_hide)})}),a("#commentlist li.pingback > .comment-body .comment-content, #commentlist li.trackback > .comment-body .comment-content").each(function(){if(a(this).prev(".trackback-toggle").length)return!0;var t=commentingL10n.tb_from.replace("%s",'<span class="tb-from">'+a(this).find("cite.fn").text()+"</span>");return a(this).hide().addClass("with-toggle").before('<div class="trackback-toggle"></div>').prev(".trackback-toggle").html(t).click(function(){a(this).next(".comment-content").slideToggle("fast")}),!0})},approveComment:function(e,t){var n={_spec_ajax:"Why is everyone looking at me",action:"approve_comment",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id,comment_id:t};a.post(commentingL10n.ajax_url,n,function(t){"done"==t?(e.text("Approval sent, verifying..."),addComment.getCommentUpdates()):addComment.error(t)})},spamComment:function(e,t){var n={_spec_ajax:"Why is everyone looking at me",action:"spam_comment",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id,comment_id:t};a.post(commentingL10n.ajax_url,n,function(t){"done"==t?(e.text("Spam req sent, verifying..."),addComment.getCommentUpdates()):addComment.error(t)})},trashComment:function(e,t){var n={_spec_ajax:"Why is everyone looking at me",action:"delete_comment",action_id:addComment.action_id,time:commentingL10n.time,post_id:commentingL10n.post_id,comment_id:t};a.post(commentingL10n.ajax_url,n,function(t){"done"==t?(e.text("Deletion sent, verifying..."),addComment.getCommentUpdates()):addComment.error(t)})},_init:function(){var t=a("form#comment-form"),e=a("#commentlist");a(document).ready(function(o){addComment.startInterval(!0),o.ajaxSetup({cache:!1,timeout:1e3*commentingL10n.polling-2e3}),t.submit(function(){return addComment.submit(this),!1}),t.on("click","#cancel-comment-reply-link",function(){return addComment.cancelReply(),!1}),e.on("click",".spec_moderation_button_approve",function(){var t=o(this).data("comment");return addComment.approveComment(o(this),t),!1}),e.on("click",".spec_moderation_button_spam",function(){var t=o(this).data("comment");return addComment.spamComment(o(this),t),!1}),e.on("click",".spec_moderation_button_delete",function(){var t=o(this).data("comment");return addComment.trashComment(o(this),t),!1}),addComment.addToggles(!0),e.on("click","div.toggle",function(){o(this).hasClass("kqofn-hidden")?o(this).removeClass("kqofn-hidden").next("ul.children").slideDown("fast",function(){o(this).prev("div.toggle").css({backgroundPosition:"bottom right"})}):o(this).addClass("kqofn-hidden").next("ul.children").slideUp("fast",function(){o(this).prev("div.toggle").css({backgroundPosition:"top left"})}),addComment.toggleToggleText(o(this))}),addComment.trackbackToggle(400),e.on("click",".comment-link",function(){var t=o(this).attr("href"),e=o(this).text(),n=o('<div class="comment-link-display"><span>'+e+'</span><input type="text" value="'+t+'" /></div>');return o("body").append(n).find(".comment-link-display").css({position:"absolute",top:o(this).offset().top-27+"px",left:o(this).offset().left+5+"px",zIndex:100,opacity:0}).fadeTo("fast",1,function(){o(this).find("input").blur(function(){o(this).parents(".comment-link-display").fadeTo("fast",0,function(){o(this).remove()})}),o(this).find("input").focus()}),!1}),e.find(".comment-link-display").on("focus","input",function(){this.select()}),o.each(o.browser,function(t,e){if("msie"==t&&!0===e)switch(parseInt(o.browser.version.substr(0,1),10)){case 6:case 7:for($target=o("#comment");"inherit"==$target.css("fontFamily");)$target=$target.parent();o("#comment").css({fontFamily:$target.css("fontFamily"),fontSize:$target.css("fontSize"),width:o("#comment").innerWidth()})}}),o("#comment").autogrow()})}},addComment._init()})}(jQuery);
//# sourceMappingURL=commenting.min.js.map
